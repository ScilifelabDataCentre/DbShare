{% extends 'base.html' %}

{% block head_title %}Plots in database {{ db['name'] }}{% endblock %}

{% block body_title %}
Plots in database <strong>{{ db['name'] }}</strong>
{% endblock %}

{% block main %}
<table id="plots" class="table table-sm">
  <thead>
    <tr>
      <th>Plot</th>
      <th>Type</th>
      <th>Description</th>
      <th>Table or view</th>
    </tr>
  </thead>
  <tbody>
    {% for sourcename, plots in db['plots'].items() %}
    {% for plot in plots %}
    <tr>
      <td>
	<a href="{{ url_for('.display', dbname=db['name'], plotname=plot['name']) }}">
	  {{ plot['name'] }}</a>
      <td>{{ plot['type'] }}</td>
      <td>{{ plot['spec'].get('description') or '' }}</td>
      <td>
	{% if plot['sourcename'] in db['tables'] %}
	<a href="{{url_for('table.rows', dbname=db['name'], tablename=plot['sourcename']) }}">
	  {{ sourcename }}</a>
	{% else %}
	<a href="{{url_for('view.rows', dbname=db['name'], viewname=plot['sourcename']) }}">
	  {{ sourcename }}</a>
	{% endif %}
      </td>
    </tr>
    {% endfor %}
    {% endfor %}
  </tbody>
</table>
{% endblock %}

{% block actions %}
{% if has_write_access %}
<div class="mt-3">
  <a href="{{ url_for('.select', dbname=db['name']) }}"
     role="button" class="btn btn-info btn-block">Create plot</a>
</div>
{% endif %} {# has_write_access #}
{% endblock %}

{% block javascript %}
<script>
  $(function() {
    $("#plots").DataTable( {
      "pagingType": "full_numbers",
      "pageLength": 25,
      "order": [[3, "asc"]]
    });
  });
</script>
{% endblock %}
